

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Logics &mdash; Developer Documentation 1.3c develop (as of 31. October 2017, commit 34c17bf) documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Developer Documentation 1.3c develop (as of 31. October 2017, commit 34c17bf) documentation" href="index.html"/>
        <link rel="next" title="Plugins" href="plugins_all.html"/>
        <link rel="prev" title="Items" href="items.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Developer Documentation
          

          
            
            <img src="_static/logo_long_inverse3.png" class="logo" />
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="user_doc.html">User Documentation (German)</a></li>
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="config.html#structure-of-smarthomeng">Structure of SmartHomeNG</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#config-files-in-directory-etc">Config files in directory <strong>etc</strong></a><ul>
<li class="toctree-l3"><a class="reference internal" href="config.html#smarthome-yaml">smarthome.yaml</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#plugin-yaml">plugin.yaml</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#logic-yaml">logic.yaml</a></li>
<li class="toctree-l3"><a class="reference internal" href="config.html#logging-yaml">logging.yaml</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html#item-definitions-in-directory-items">Item definitions in directory <strong>items</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#logic-definitions-in-directory-logics">Logic definitions in directory <strong>logics</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html#smarthomeng-start-options">SmartHomeNG start options</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="items.html">Items</a><ul>
<li class="toctree-l2"><a class="reference internal" href="items.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="items.html#item-attributes">Item Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="items.html#item-functions">Item functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="items.html#example-logic-with-uses-of-above-functions">Example logic with uses of above functions</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Logics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-parameters">Configuration parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#watch-item">watch_item</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cycle">cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#crontab">crontab</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enabled">enabled</a></li>
<li class="toctree-l3"><a class="reference internal" href="#prio">prio</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-parameters">Other parameters</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#basic-structure-of-a-logic-script">Basic Structure of a logic script</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loaded-python-modules">Loaded Python modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#available-objects-methods">Available Objects/Methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#logic">logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logic-trigger">logic.trigger()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trigger">trigger</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#logger-and-sh-log">logger and sh.log</a></li>
<li class="toctree-l2"><a class="reference internal" href="#smarthomeng-methods-to-use">SmartHomeNG methods to use</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sh-now-and-sh-utcnow">sh.now and sh.utcnow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-sun">sh.sun</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-moon">sh.moon</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#scheduling">Scheduling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sh-scheduler-trigger-sh-trigger">sh.scheduler.trigger() / sh.trigger()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-scheduler-change">sh.scheduler.change()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sh-tools-object">sh.tools object</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sh-tools-ping">sh.tools.ping()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-tools-dewpoint">sh.tools.dewpoint()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-tools-fetch-url">sh.tools.fetch_url()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-tools-dt2ts-dt">sh.tools.dt2ts(dt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-tools-dt2js-dt">sh.tools.dt2js(dt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-tools-rel2abs-temp-hum">sh.tools.rel2abs(temp, hum)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#accessing-items">Accessing items</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#sh-return-item-path">sh.return_item(path)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-return-items">sh.return_items()</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-match-items-regex">sh.match_items(regex)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sh-find-items-configattribute">sh.find_items(configattribute)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#find-children-parentitem-configattribute">find_children(parentitem, configattribute):</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plugins_all.html">Plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plugins_doc/plugins_system.html">System Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins/backend/README.html">Backend GUI (beyond shNG v1.3)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/blockly/README.html">Blockly Logic Editor (beyond shNG v1.3)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/cli/README.html">CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/database/README.html">Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/datalog/README.html">DataLog</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/influxdata/README.html">influxdata</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/influxdb/README.html">Influxdb</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/memlog/README.html">MemLog</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/operationlog/README.html">OperationLog</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/rrd/README.html">RRDTool</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/rtr/README.html">RTR plug-in</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/simulation/README.html">Simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/sqlite/README.html">SQLite (for SmartVisu &lt; 2.8)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/sqlite_visu2_8/README.html">SQLite (for SmartVisu &gt;= 2.8)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/uzsu/README.html">UZSU</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/visu_smartvisu/README.html">Visualisation (smartVISU support)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/visu_websocket/README.html">Visualisation (Websocket Protocol)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins_doc/plugins_gateway.html">Gateway Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins/artnet/README.html">Artnet</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/dashbutton/README.html">Amazon Dashbutton Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/dmx/README.html">DMX</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/ecmd/README.html">ECMD</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/elro/README.html">Elro</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/enocean/README.html">EnOcean</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/hue/README.html">Phillips HUE</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/iaqstick/README.html">iAQ Stick</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/knx/README.html">KNX</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/lirc/README.html">lirc</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/milight/README.html">miLight</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/mlgw/README.html">Bang &amp; Olufsen Masterlink Gateway</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/mpd/README.html">MPD</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/onewire/README.html">Onewire</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/raumfeld/README.html">Raumfeld</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/rcswitch/README.html">RCswitch</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/smawb/README.html">SMA-WebBox (smawb)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/snom/README.html">snom</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/sonos/README.html">Sonos</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/squeezebox/README.html">Squeezebox</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/tellstick/README.html">Tellstick</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins_doc/plugins_interface.html">Interface Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins/apcups/README.html">APC UPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/asterisk/README.html">Asterisk</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/avdevice/README.html">AV Device</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/avm/README.html">AVM</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/buderus/README.html">buderus</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/comfoair/README.html">ComfoAir</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/dlms/README.html">DLMS</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/drexelundweiss/README.html">Drexel &amp; Weiss</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/easymeter/README.html">Easymeter</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/ebus/README.html">eBus</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/enigma2/README.html">Enigma2</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/eta_pu/README.html">ETA Pellet Unit PU</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/gpio/README.html">GPIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/harmony/README.html">Harmony Hub Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/helios/README.html">Helios ECx00Pro / Vallox xx SE Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/homematic/README.html">homematic</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/intercom_2n/README.html">2N-Intercom Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/kathrein/README.html">Kathrein</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/kostal/README.html">KOSTAL</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/logo/README.html">logo</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/luxtronic2/README.html">Luxtronic2</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/netio230b/README.html">NetIO230B</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/nuki/README.html">Nuki</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/nut/README.html">NUT - Network UPS Tools plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/plex/README.html">plex</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/pluggit/README.html">PLUGGIT</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/roomba/README.html">Roomba</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/russound/README.html">Russound</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/sma/README.html">SMA</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/sma_em/README.html">SMA-EM Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/smarttv/README.html">SmartTV</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/sml/README.html">Sml</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/solarlog/README.html">Solarlog</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/systemair/README.html">Systemair</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/volkszaehler/README.html">Volkszaehler Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/vr100/README.html">VR100</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/xbmc/README.html">XBMC</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/xiaomi/README.html">Xiaomi</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/yamaha/README.html">Yamaha</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins_doc/plugins_protocol.html">Protocol Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins/mqtt/README.html">MQTT</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/mqtt_1_0/README.html">MQTT 1.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/network/README.html">Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/wol/README.html">WakeOnLan</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/xmpp/README.html">XMPP</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins_doc/plugins_web.html">Web/Cloud Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins/alexa/README.html">Alexa</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/boxcar/README.html">Boxcar Notification Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/dwd/README.html">DWD</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/ical/README.html">iCal</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/join/README.html">Join</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/mail/README.html">Mail</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/mvg_live/README.html">MVG Live</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/nma/README.html">nma - Notify My Android</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/nokia_health/README.html">Nokia Health</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/odlinfo/README.html">ODLInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/openenergymonitor/README.html">OpenEnergyMonitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/prowl/README.html">Prowl</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/pushbullet/README.html">Pushbullet</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/speech/README.html">Speech Parser</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/tankerkoenig/README.html">TankerKoenig</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/telegram/README.html">Telegram</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/traffic/README.html">Traffic</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/webservices/README.html">WebServices plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/wettercom/README.html">wetter.com</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins/wunderground/README.html">Wunderground</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins_doc/plugins_unclassified.html">Unclassified Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="plugins/pushover/README.html">Pushover</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modules.html">Modules for use with plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/dummy/README.html">Module dummy</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/http/README.html">Module http</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules_doc/module_metadata.html">Module Metadata</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tools/backup_restore.html">tools.backup_restore</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools/build_requirements.html">tools.build_requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="tools/conf_to_yaml_converter.html">tools.conf_to_yaml_converter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development_plugins.html">Development of Plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dev/README.html">Plugin development guidelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="development_plugin/plugin_in5minutes.html">How to write a Plugin in 5 min.</a></li>
<li class="toctree-l2"><a class="reference internal" href="development_plugin/smartplugin.html">Class SmartPlugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="development_plugin/plugin_metadata.html">Plugin Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="development_plugin/sampleplugins.html">Sample Plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="development_plugin/sampleplugin.html">Sample Plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="development_plugin/sampleplugin_webif.html">Sample Plugin with web interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="development_plugin/sampleplugin_1_1.html">Sample Plugin (old v1.1)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modules_doc/modules_plugins.html">Modules for use with plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules_doc/module_dummy.html">Module dummy</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules_doc/module_http.html">Module http</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modules_doc/modules_readmes.html">READMEs for Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules/dummy/README.html">Module dummy</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules/http/README.html">Module http</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="development_plugin/libraries_plugins.html">Libraries for use in plugins</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/connection.html">lib.connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/db.html">lib.db</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/logutils.html">lib.logutils</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/network.html">lib.network</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/orb.html">lib.orb</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/scheduler.html">lib.scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/tools.html">lib.tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/utils.html">lib.utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins/visu_smartvisu/README_for_developers.html">Visualisation plugin (smartVISU support) - for developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins/visu_websocket/README_for_visu_developers.html">Visualisation plugin (Websocket Protocol) - for developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="development_core.html">Development - Core</a><ul>
<li class="toctree-l2"><a class="reference internal" href="core.html">Core of SmartHomeNG</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_libraries.html">Libraries</a><ul>
<li class="toctree-l3"><a class="reference internal" href="lib/config.html">lib.config</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/constants.html">lib.constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/daemon.html">lib.daemon</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/item.html">lib.item</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/item_conversion.html">lib.item_conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/log.html">lib.log</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/logic.html">lib.logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/metadata.html">lib.metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/module.html">lib.module</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/plugin.html">lib.plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/scene.html">lib.scene</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/shyaml.html">lib.shyaml</a></li>
<li class="toctree-l3"><a class="reference internal" href="-----.html">&gt;———-&lt;</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/connection.html">lib.connection</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/db.html">lib.db</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/logutils.html">lib.logutils</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/network.html">lib.network</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/orb.html">lib.orb</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/scheduler.html">lib.scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/tools.html">lib.tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="lib/utils.html">lib.utils</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="core_modules.html">Core modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modules_doc/modules_readmes.html">READMEs for Modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="modules_doc/module_metadata.html">Module Metadata</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="release/1_3.html">Release 1.3 - August 5th, 2017</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/1_2.html">Release 1.2 - May 16th, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/1_1.html">Release 1.1 - April 13th, 2016</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/1_0.html">Release 1.0 - November 14th, 2013</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/0_9.html">Release 0.9 - June 6th 2013</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/0_8.html">Release 0.8 - January 31st, 2013</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/0_7.html">Release 0.7 - September 27th 2012</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/0_6.html">Release 0.6 - June 21th, 2012</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/0_5.html">Release 0.5 - July 12th, 2012</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/0_4.html">Release 0.4 - October 10th, 2011</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/0_3.html">Release 0.3 - August 14th, 2011</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/0_2.html">Release 0.2 - June 21st, 2011</a></li>
<li class="toctree-l2"><a class="reference internal" href="release/0_1.html">Release 0.1 - April 09th, 2011</a></li>
</ul>
</li>
</ul>

            
          
    <a href="genindex.html">Index</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Developer Documentation</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Logics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/logics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="logics">
<h1>Logics</h1>
<div class="section" id="introduction">
<h2>Introduction</h2>
<p>Logics itself are just scripts written in Python and they reside in subdirectory <code class="docutils literal"><span class="pre">logics/</span></code>.
All logics are configured within <code class="docutils literal"><span class="pre">etc/logic.conf</span></code> (deprecated) or starting with SmartHomeNG 1.3
<code class="docutils literal"><span class="pre">etc/logic.yaml</span></code>. The configuration file tells SmartHomeNG when to execute a certain logic script.</p>
<p>The following sample configuration file defines four logic scripts for use by SmartHomeNG.
The first logic script resides in <code class="docutils literal"><span class="pre">logics/InitSmartHomeNG.py</span></code>. The attribute <code class="docutils literal"><span class="pre">crontab</span> <span class="pre">=</span> <span class="pre">init</span></code> tells SmartHomeNG
to start the script just after SmartHomeNG has started.
The second logic script resides in <code class="docutils literal"><span class="pre">logics/time.py</span></code> and the attribute <code class="docutils literal"><span class="pre">cycle</span> <span class="pre">=</span> <span class="pre">60</span></code> tells SmartHomeNG to call the
script every 60 minutes. The third logic script resides in <code class="docutils literal"><span class="pre">logics/gate.py</span></code> and the attribute
<code class="docutils literal"><span class="pre">watch_item</span> <span class="pre">=</span> <span class="pre">gate.alarm</span></code> tells SmartHomeNG to call the script when item value of gate.alarm changed. Now it’s easy
to guess where the forth script resides in and when it is called by SmartHomeNG.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">/usr/local/smarthome/etc/logic.conf (deprecated)</span></div>
<div class="highlight-text"><div class="highlight"><pre><span></span>[InitSmarthomeNG]
     filename = InitSmartHomeNG.py
     crontab = init

[Hourly]
    filename = time.py
    cycle = 60

[Gate]
    filename = gate.py
    watch_item = gate.alarm # monitor for changes

[disks]
     filename = disks.py
     crontab = init | 0,5,10,15,20,25,30,35,40,45,50,55 * * * # run at start and every 5 minutes
     usage_warning = 500
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">/usr/local/smarthome/etc/logic.yaml</span></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">InitSmarthomeNG</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">filename</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">InitSmartHomeNG.py</span>
    <span class="l l-Scalar l-Scalar-Plain">crontab</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">init</span>

<span class="l l-Scalar l-Scalar-Plain">Hourly</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">filename</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">time.py</span>
    <span class="l l-Scalar l-Scalar-Plain">cycle</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">60</span>

<span class="l l-Scalar l-Scalar-Plain">Gate</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">filename</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">gate.py</span>
    <span class="l l-Scalar l-Scalar-Plain">watch_item</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">gate.alarm</span>    <span class="c1"># monitor for changes</span>

<span class="l l-Scalar l-Scalar-Plain">disks</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">filename</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">disks.py</span>
    <span class="c1"># &#39;crontab: run at start and every 5 minutes&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">crontab</span><span class="p p-Indicator">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">init</span>
      <span class="p p-Indicator">-</span> <span class="s">&#39;0,5,10,15,20,25,30,35,40,45,50,55</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*&#39;</span>
    <span class="l l-Scalar l-Scalar-Plain">usage_warning</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">500</span>
</pre></div>
</div>
</div>
<p>Within the <code class="docutils literal"><span class="pre">etc/logic.conf</span></code> (deprecated) / <code class="docutils literal"><span class="pre">etc/logic.conf</span></code> the following attributes control the execution of a logic:</p>
</div>
<div class="section" id="configuration-parameters">
<h2>Configuration parameters</h2>
<p>The following parameters can be used in <cite>etc/logic.yaml</cite> to configure the logic and it’s behaviour.</p>
<div class="section" id="watch-item">
<h3>watch_item</h3>
<p>The list of items will be monitored for changes.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">Configuration in CONF syntax (deprecated)</span></div>
<div class="highlight-text"><div class="highlight"><pre><span></span>watch_item = house.alarm | garage.alarm
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">Configuration in YAML syntax</span></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">watch_item</span><span class="p p-Indicator">:</span>
 <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">house.alarm</span>
 <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">garage.alarm</span>
</pre></div>
</div>
</div>
<p>Any change of the item <strong>house.alarm</strong> and <strong>garage.alarm</strong> triggers the execution of the given logic.
It is possible to use an asterisk * for any path part (like a regular expression):</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Configuration in CONF syntax (deprecated)</span></div>
<div class="highlight-text"><div class="highlight"><pre><span></span>watch_item = *.door
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Configuration in YAML syntax</span></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">watch_item</span><span class="p p-Indicator">:</span> <span class="s">&#39;*.door&#39;</span>
</pre></div>
</div>
</div>
<p>this will trigger <strong>garage.door</strong> and also <strong>house.door</strong> but <em>not</em> <strong>house.hallway.door</strong></p>
</div>
<div class="section" id="cycle">
<h3>cycle</h3>
<p>This will trigger the given logic in a recurring way</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">Configuration in CONF syntax (deprecated)</span></div>
<div class="highlight-text"><div class="highlight"><pre><span></span>cycle = 60
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Configuration in YAML syntax</span></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">cycle</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">60</span>
</pre></div>
</div>
</div>
<p>Optional use a parameter</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Configuration in CONF syntax (deprecated)</span></div>
<div class="highlight-text"><div class="highlight"><pre><span></span>cycle = 60 = 100
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">Configuration in YAML syntax</span></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">cycle</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">60 = 100</span>
</pre></div>
</div>
</div>
<p>This triggers the logic every 60 minutes and passes the values 100 to the logic.
The object trigger[‘value’] can be queried and will here result in ‘100’</p>
</div>
<div class="section" id="crontab">
<h3>crontab</h3>
<p>Like Unix crontab with the following options:</p>
<p><code class="docutils literal"><span class="pre">crontab</span> <span class="pre">=</span> <span class="pre">init</span></code> (conf) / <code class="docutils literal"><span class="pre">crontab:</span> <span class="pre">init</span></code> (yaml) Run the logic during the start of SmartHomeNG.</p>
<p><code class="docutils literal"><span class="pre">crontab</span> <span class="pre">=</span> <span class="pre">minute</span> <span class="pre">hour</span> <span class="pre">day</span> <span class="pre">wday</span></code> (conf) / <code class="docutils literal"><span class="pre">crontab:</span> <span class="pre">minute</span> <span class="pre">hour</span> <span class="pre">day</span> <span class="pre">wday</span></code> (yaml)</p>
<ul class="simple">
<li>minute: single value from 0 to 59, or comma separated list, or * (every minute)</li>
<li>hour: single value from 0 to 23, or comma separated list, or * (every hour)</li>
<li>day: single value from 0 to 28, or comma separated list, or * (every day)
Please note: dont use days greater than 28 in the moment.</li>
<li>wday: weekday, single value from 0 to 6 (0 = Monday), or comma separated list, or * (every day)</li>
</ul>
<p><code class="docutils literal"><span class="pre">crontab</span> <span class="pre">=</span> <span class="pre">sunrise</span></code> (conf) / <code class="docutils literal"><span class="pre">crontab:</span> <span class="pre">sunrise</span> <span class="pre">(yaml)</span> <span class="pre">Runs</span> <span class="pre">the</span> <span class="pre">logic</span> <span class="pre">at</span> <span class="pre">every</span> <span class="pre">sunrise.</span> <span class="pre">Use</span> <span class="pre">``sunset</span></code> to run
at sunset. For sunset / sunrise you could provide:</p>
<ul class="simple">
<li>an horizon offset in degrees e.g. crontab = sunset-6 You have to
specify your latitude/longitude in smarthome.conf.</li>
<li>an offset in minutes specified by a ‘m’ e.g. crontab = sunset-10m</li>
<li>a boundary for the execution</li>
</ul>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">Configuration in CONF syntax (deprecated)</span></div>
<div class="highlight-text"><div class="highlight"><pre><span></span> crontab = 17:00&lt;sunset        # sunset, but not bevor 17:00 (locale time)
 crontab = sunset&lt;20:00        # sunset, but not after 20:00 (locale time)
 crontab = 17:00&lt;sunset&lt;20:00  # sunset, beetween 17:00 and 20:00
 crontab = 15 * * * = 50       # Calls the logic with trigger[&#39;value&#39;] # == 50
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">Configuration in YAML syntax</span></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span> <span class="l l-Scalar l-Scalar-Plain">crontab</span><span class="p p-Indicator">:</span> <span class="s">&#39;17:00&lt;sunset&#39;</span>        <span class="c1"># sunset, but not bevor 17:00 (locale time)</span>
 <span class="l l-Scalar l-Scalar-Plain">crontab</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sunset&lt;20:00</span>          <span class="c1"># sunset, but not after 20:00 (locale time)</span>
 <span class="l l-Scalar l-Scalar-Plain">crontab</span><span class="p p-Indicator">:</span> <span class="s">&#39;17:00&lt;sunset&lt;20:00&#39;</span>  <span class="c1"># sunset, beetween 17:00 and 20:00</span>
 <span class="l l-Scalar l-Scalar-Plain">crontab</span><span class="p p-Indicator">:</span> <span class="s">&#39;15</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">50&#39;</span>       <span class="c1"># Calls the logic with trigger[&#39;value&#39;] # == 50</span>
</pre></div>
</div>
</div>
<p>Combine several options with <code class="docutils literal"><span class="pre">|</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">Configuration in CONF syntax (deprecated)</span></div>
<div class="highlight-text"><div class="highlight"><pre><span></span>crontab = init = &#39;start&#39; | sunrise-2 | 0 5 * *
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">Configuration in YAML syntax</span></div>
<div class="highlight-yaml"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">crontab</span><span class="p p-Indicator">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">init = start</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">sunrise-2</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;0</span><span class="nv"> </span><span class="s">5</span><span class="nv"> </span><span class="s">*</span><span class="nv"> </span><span class="s">*&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="enabled">
<h3>enabled</h3>
<p><code class="docutils literal"><span class="pre">enabled</span></code> can be set to False to disable the execution of the logic after loading. The status
of the logic (enabled/disabled) can be controlled via the plugins <code class="docutils literal"><span class="pre">backend</span></code> or <code class="docutils literal"><span class="pre">cli</span></code></p>
</div>
<div class="section" id="prio">
<h3>prio</h3>
<p>Sets the priority of the logic script within the execution context of the scheduler.
Any value between 1 to 10 is allowed where 1 has the highest priority and 10 the lowest.
Usually you don’t need to specify a priority. The default priority is 5.</p>
</div>
<div class="section" id="other-parameters">
<h3>Other parameters</h3>
<p>Other parameters could be accessed from the the logic with self.parameter_name.
Like in the first example script for the fourth logic the attribute <code class="docutils literal"><span class="pre">usage_warning:</span> <span class="pre">500</span></code></p>
</div>
</div>
<div class="section" id="basic-structure-of-a-logic-script">
<h2>Basic Structure of a logic script</h2>
<p>The most important object is the smarthome object <code class="docutils literal"><span class="pre">sh</span></code>.
Using this object all items, plugins and basic functions of SmartHomeNG can be accessed.
To query an item’s value call: <code class="docutils literal"><span class="pre">sh.area.item()</span></code>
To set a new value just specify it as argument sh.area.item(new_value).</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># put on the light in the living room, if it is not on</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">sh</span><span class="o">.</span><span class="n">living_room</span><span class="o">.</span><span class="n">light</span><span class="p">():</span>
    <span class="n">sh</span><span class="o">.</span><span class="n">living_room</span><span class="o">.</span><span class="n">light</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Items need to be accessed with parentheses, otherwise an exception will be raised</p>
<p><code class="docutils literal"><span class="pre">sh</span></code> can be used to iterate over the item objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sh</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">item</span>
    <span class="k">for</span> <span class="n">child_item</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">child_item</span>
</pre></div>
</div>
</div>
<div class="section" id="loaded-python-modules">
<h2>Loaded Python modules</h2>
<p>In the logic environment are several python modules already loaded:</p>
<ul class="simple">
<li>sys</li>
<li>os</li>
<li>time</li>
<li>datetime</li>
<li>ephem</li>
<li>random</li>
<li>Queue</li>
<li>subprocess</li>
</ul>
<p>you could however import more modules as needed with the import statement.</p>
</div>
<div class="section" id="available-objects-methods">
<h2>Available Objects/Methods</h2>
<p>Beside the ‘sh’ object other important predefined objects are available.</p>
<div class="section" id="logic">
<h3>logic</h3>
<p>This object provides access to the current logic object. It is possible
to change logic attributes (crontab, cycle, …) during runtime. They
will be lost after restarting SmartHomeNG. <code class="docutils literal"><span class="pre">while</span> <span class="pre">logic.alive:</span></code>
creates an endless loop. This way SmartHomeNG could stop the loop at
shutdown. Next section (trigger) describes the special function
<code class="docutils literal"><span class="pre">logic.trigger()</span></code>. Predefined attributs of the logic object:</p>
<ul class="simple">
<li>logic.name: with the name of the logic as specified in logic.conf</li>
<li>logic.last_time(): this function provides the last run of this logic
(before the recent one)</li>
<li>logic.prio: read and set of the current priority of this logic.</li>
</ul>
</div>
<div class="section" id="logic-trigger">
<h3>logic.trigger()</h3>
<p>Equal to <code class="docutils literal"><span class="pre">sh.trigger()</span></code>, but it triggers only the current logic. This
function is useful to run the logic (again) at a specified time.</p>
</div>
<div class="section" id="trigger">
<h3>trigger</h3>
<p><code class="docutils literal"><span class="pre">trigger</span></code> is a runtime environment for the logic, which provides some
information about the event that triggered the logic.</p>
<p>It is a dictionary which can be used by: <code class="docutils literal"><span class="pre">trigger['by']</span></code>,
<code class="docutils literal"><span class="pre">trigger['source']</span></code>, <code class="docutils literal"><span class="pre">trigger['dest']</span></code> and <code class="docutils literal"><span class="pre">trigger['value']</span></code>.</p>
</div>
</div>
<div class="section" id="logger-and-sh-log">
<h2>logger and sh.log</h2>
<p>This object is useful to generate log messages. It provides five
different log levels: debug, info, warning, error, critical.
logger.level(str) e.g. logger.info(‘42’). The log messages are stored in
the log file and the latest 50 entries are also in ‘sh.log’ available.
So its possible to access the messages by plugins (visu) and logics.
Attention: the datetime in every log entry is the timezone aware
localtime.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># a simple loop over the log messages</span>
<span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">sh</span><span class="o">.</span><span class="n">log</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="c1"># remark: if SmartHomeNG is run in daemon mode output by &#39;print&#39; is not visible.</span>
</pre></div>
</div>
</div>
<div class="section" id="smarthomeng-methods-to-use">
<h2>SmartHomeNG methods to use</h2>
<div class="section" id="sh-now-and-sh-utcnow">
<h3>sh.now and sh.utcnow</h3>
<p>These two functions return a timezone-aware datetime object. Its
possible to compute with different timezones. sh.tzinfo() and
sh.utcinfo() address a local and the UTC timezone.</p>
</div>
<div class="section" id="sh-sun">
<h3>sh.sun</h3>
<p>This module provides access to parameters of the sun. In order to use
this module, it is required to specify the latitude (e.g. lat = 51.1633)
and longitude (e.g. lon = 10.4476) in the smarthome.conf file!</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># sh.sun.pos([offset], [degree=False]) specifies an optional minute offset and if the return values should be degrees instead of the default radians.</span>
<span class="n">azimut</span><span class="p">,</span> <span class="n">altitude</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">pos</span><span class="p">()</span> <span class="c1"># return the current sun position</span>
<span class="n">azimut</span><span class="p">,</span> <span class="n">altitude</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">pos</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># return the current sun position in degrees</span>
<span class="n">azimut</span><span class="p">,</span> <span class="n">altitude</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">pos</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="c1"># return the sun position 30 minutes</span>
                                  <span class="c1"># in the future.</span>

<span class="c1"># sh.sun.set([offset]) specifies a degree offset.</span>
<span class="n">sunset</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">set</span><span class="p">()</span> <span class="c1"># Returns a utc! based datetime object with the next</span>
                      <span class="c1"># sunset.</span>
<span class="n">sunset_tw</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># Would return the end of the twilight.</span>

<span class="c1"># sh.sun.rise([offset]) specifies a degree offset.</span>
<span class="n">sunrise</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">rise</span><span class="p">()</span> <span class="c1"># Returns a utc! based datetime object with the next</span>
                        <span class="c1"># sunrise.</span>
<span class="n">sunrise_tw</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="n">sun</span><span class="o">.</span><span class="n">rise</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># Would return the start of the twilight.</span>
</pre></div>
</div>
</div>
<div class="section" id="sh-moon">
<h3>sh.moon</h3>
<p>Besides the three functions (pos, set, rise) it provides two more.
<code class="docutils literal"><span class="pre">sh.moon.light(offset)</span></code> provides a value from 0 - 100 of the
illuminated surface at the current time + offset.
<code class="docutils literal"><span class="pre">sh.moon.phase(offset)</span></code> returns the lunar phase as an integer [0-7]: 0
= new moon, 4 = full moon, 7 = waning crescent moon</p>
</div>
</div>
<div class="section" id="scheduling">
<h2>Scheduling</h2>
<div class="section" id="sh-scheduler-trigger-sh-trigger">
<h3>sh.scheduler.trigger() / sh.trigger()</h3>
<p>This global function triggers any specified logic by its name.
<code class="docutils literal"><span class="pre">sh.trigger(name</span> <span class="pre">[,</span> <span class="pre">by]</span> <span class="pre">[,</span> <span class="pre">source]</span> <span class="pre">[,</span> <span class="pre">value]</span> <span class="pre">[,</span> <span class="pre">dt])</span></code> <code class="docutils literal"><span class="pre">name</span></code>
(mandatory) defines the logic to trigger. <code class="docutils literal"><span class="pre">by</span></code> a name of the calling
logic. By default its set to ‘Logic’. <code class="docutils literal"><span class="pre">source</span></code> the reason for
triggering. <code class="docutils literal"><span class="pre">value</span></code> a variable. <code class="docutils literal"><span class="pre">dt</span></code> timezone aware datetime object,
which specifies the triggering time.</p>
</div>
<div class="section" id="sh-scheduler-change">
<h3>sh.scheduler.change()</h3>
<p>This method changes some runtime options of the logics.
<code class="docutils literal"><span class="pre">sh.scheduler.change('alarmclock',</span> <span class="pre">active=False)</span></code> disables the logic
‘alarmclock’. Besides the <code class="docutils literal"><span class="pre">active</span></code> flag, it is possible to change:
<code class="docutils literal"><span class="pre">cron</span></code> and <code class="docutils literal"><span class="pre">cycle</span></code>.</p>
</div>
</div>
<div class="section" id="sh-tools-object">
<h2>sh.tools object</h2>
<p>The <code class="docutils literal"><span class="pre">sh.tools</span></code> object provide some useful functions:</p>
<div class="section" id="sh-tools-ping">
<h3>sh.tools.ping()</h3>
<p>Pings a computer and returns True if the computer responds, otherwise
False. <code class="docutils literal"><span class="pre">sh.office.laptop(sh.tools.ping('hostname'))</span></code></p>
</div>
<div class="section" id="sh-tools-dewpoint">
<h3>sh.tools.dewpoint()</h3>
<p>Calculate the dewpoint for the provided temperature and humidity.
<code class="docutils literal"><span class="pre">sh.office.dew(sh.tools.dewpoint(sh.office.temp(),</span> <span class="pre">sh.office.hum())</span></code></p>
</div>
<div class="section" id="sh-tools-fetch-url">
<h3>sh.tools.fetch_url()</h3>
<p>Return a website as a String or ‘False’ if it fails.
<code class="docutils literal"><span class="pre">sh.tools.fetch_url('https://www.regular.com')</span></code> Its possible to use
‘username’ and ‘password’ to authenticate against a website.
<code class="docutils literal"><span class="pre">sh.tools.fetch_url('https://www.special.com',</span> <span class="pre">'username',</span> <span class="pre">'password')</span></code>
Or change the default ‘timeout’ of two seconds.
<code class="docutils literal"><span class="pre">sh.tools.fetch_url('https://www.regular.com',</span> <span class="pre">timeout=4)</span></code></p>
</div>
<div class="section" id="sh-tools-dt2ts-dt">
<h3>sh.tools.dt2ts(dt)</h3>
<p>Converts an datetime object to a unix timestamp.</p>
</div>
<div class="section" id="sh-tools-dt2js-dt">
<h3>sh.tools.dt2js(dt)</h3>
<p>Converts an datetime object to a json timestamp.</p>
</div>
<div class="section" id="sh-tools-rel2abs-temp-hum">
<h3>sh.tools.rel2abs(temp, hum)</h3>
<p>Converts the relative humidity to the absolute humidity.</p>
</div>
</div>
<div class="section" id="accessing-items">
<h2>Accessing items</h2>
<div class="section" id="sh-return-item-path">
<h3>sh.return_item(path)</h3>
<p>Returns an item object for the specified path. E.g.
<code class="docutils literal"><span class="pre">sh.return_item('first_floor.bath')</span></code></p>
</div>
<div class="section" id="sh-return-items">
<h3>sh.return_items()</h3>
<p>Returns all item objects.
.. code-block:: python</p>
<blockquote>
<div><dl class="docutils">
<dt>for item in sh.return_items():</dt>
<dd>logger.info(item.id())</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="sh-match-items-regex">
<h3>sh.match_items(regex)</h3>
<p>Returns all items matching a regular expression path and optional attribute.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sh</span><span class="o">.</span><span class="n">match_items</span><span class="p">(</span><span class="s1">&#39;*.lights&#39;</span><span class="p">):</span>     <span class="c1"># selects all items ending with &#39;lights&#39;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">())</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sh</span><span class="o">.</span><span class="n">match_items</span><span class="p">(</span><span class="s1">&#39;*.lights:special&#39;</span><span class="p">):</span>     <span class="c1"># selects all items ending with &#39;lights&#39; and attribute &#39;special&#39;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">id</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="sh-find-items-configattribute">
<h3>sh.find_items(configattribute)</h3>
<p>Returns all items with the specified config attribute
.. code-block:: python</p>
<blockquote>
<div><dl class="docutils">
<dt>for item in sh.find_items(‘my_special_attribute’):</dt>
<dd>logger.info(item.id())</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="find-children-parentitem-configattribute">
<h3>find_children(parentitem, configattribute):</h3>
<p>Returns all children items with the specified config attribute.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plugins_all.html" class="btn btn-neutral float-right" title="Plugins" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="items.html" class="btn btn-neutral" title="Items" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016-2017 SmartHomeNG Team, based on smarthome.py © 2011-2014 Marcus Popp.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.3c develop (as of 31. October 2017, commit 34c17bf)',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>